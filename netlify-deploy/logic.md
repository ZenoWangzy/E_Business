# 电商详情页生成工具业务逻辑 (Business Logic)

## 1. 核心流程 (Core Workflow)
本项目是一个纯前端的电商详情页生成工具，无需后端服务，直接在浏览器中运行。
- **状态管理**: 通过 `steps.js` 中的 `currentStep` 控制流程（1-4步），`userData` 对象暂存用户上传的素材和选择的配置。
- **技术栈**: 原生 HTML5/CSS3/JavaScript，配合 CDN 引入的 `pdf.js` (PDF解析), `mammoth.js` (Word解析), `xlsx` (Excel解析)。

## 2. 详细步骤逻辑 (Detailed Steps)

### 步骤 1: 上传素材 (Upload Assets)
用户上传制作详情页所需的基础素材。
- **输入项**:
    1. **商品白底图** (必填): 用于生成过程中的展示和占位。
    2. **产品说明书** (选填): 支持上传图片或文档。
    3. **工厂信息** (选填): 支持上传图片或文档（如证书、车间图等）。
- **文件处理逻辑** (`app.js`):
    - **图片**: 直接使用 `FileReader` 读取为 DataURL 进行展示。
    - **文档 (PDF/Word/Excel)**:
        - 系统会自动识别文件后缀。
        - **PDF**: 调用 `pdf.js` 逐页读取文本内容并展示。
        - **Word**: 调用 `mammoth.js` 提取文档纯文本。
        - **Excel**: 调用 `xlsx` 读取所有 Sheet 的前20行数据作为预览。
    - 所有解析后的文本内容会在界面即时呈现，供用户核对。

### 步骤 2: 选择品类 (Select Category)
用户设定商品的所属类别，可能影响生成的文案或布局（目前逻辑主要用于标记）。
- **数据源**: `app.js` 中定义了约 50 个常用电商类目（如"办公、文体", "鞋", "家具"等）。
- **交互**:
    - 网格列表展示所有类目。
    - 顶部提供实时搜索框，支持关键词过滤。
    - 单选操作，选中后记录到 `userData.category`。

### 步骤 3: 选择风格 (Select Style)
用户设定生成图片的设计风格。
- **预设风格**:
    1. **现代简约** (Modern) - 蓝紫渐变
    2. **高端奢华** (Luxury) - 粉红渐变
    3. **清新自然** (Fresh) - 青蓝渐变
    4. **科技感** (Tech) - 绿青渐变
    5. **温馨风格** (Warm) - 暖黄渐变
    6. **商务专业** (Business) - 深蓝渐变
- **逻辑**: 选择风格主要决定了生成图片时的背景色调（SVG背景）。

### 步骤 4: 生成与编辑 (Generation & Editing)
系统根据前三步的输入，自动生成一系列详情页图片，并提供强大的编辑功能。

#### 4.1 自动生成逻辑 (`generator.js`)
- **数量规则**:
    - **轮播图**: 随机生成 5-8 张。
    - **详情页**: 随机生成 10-13 张。
- **内容生成**:
    - 使用 SVG 动态生成图片。
    - **背景色**: 根据选择的风格或预设的色板（轮播图为明亮色系，详情页为深色系）循环使用。
    - **文字**: 自动填充预设的文案模板（如"核心卖点", "场景应用"等）。

#### 4.2 编辑功能
生成的图片列表支持高度自由的二次编辑：
- **拖拽排序 (Drag & Drop)**:
    - 支持 360 度自由拖拽（不仅限于列表上下，还支持网格布局的各个方向）。
    - 智能判定插入位置（基于鼠标相对于目标元素的象限）。
- **文本编辑**:
    - 每张图片卡片下方提供输入框。
    - 支持直接修改图片上的说明文字。
- **参照图 (Reference Image)**:
    - 用户可以为每一张生成的占位图上传一张"参照图"。
    - 参照图显示在占位图左侧，方便设计师参考制作。
- **重新生成**:
    - 提供"刷新"按钮，可单独重新生成某张图片的配色（模拟AI重新生成的效果）。
- **删除/批量操作**:
    - 支持单张删除。
    - 支持勾选多张后批量删除。
    - 支持"全选/反选"。

#### 4.3 预览与导出
- **预览模式**:
    - **轮播图**: 提供类似电商APP的左右滑动预览模式。
    - **详情页**: 提供垂直无缝拼接的"长图预览"模式 (Canvas绘制)。
- **下载**:
    - **单张下载**: 在预览模式下下载当前图片。
    - **长图下载**: 将详情页自动拼接为一张完整的 PNG 长图进行下载。


